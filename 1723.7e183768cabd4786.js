"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1723],{1723:(x,p,l)=>{l.r(p),l.d(p,{LoginPage:()=>M});var P=l(467),f=l(2881),a=l(9417),t=l(3092),F=l(8032),_=l.n(F),d=l(9967),e=l(1360),O=l(5096),D=l(4796);function L(r,m){1&r&&(e.j41(0,"ion-text",12),e.EFF(1," El correo es obligatorio "),e.k0s())}function C(r,m){1&r&&(e.j41(0,"ion-text",12),e.EFF(1," El correo es inv\xe1lido "),e.k0s())}function I(r,m){1&r&&(e.j41(0,"ion-text",12),e.EFF(1," La contrase\xf1a es obligatoria "),e.k0s())}function b(r,m){1&r&&(e.j41(0,"ion-text",12),e.EFF(1," La contrase\xf1a debe tener m\xednimo 6 caracteres "),e.k0s())}let M=(()=>{var r;class m{constructor(n,o,i,s,u,g){this.router=n,this.loadingController=o,this.formBuilder=i,this.authService=s,this.menuController=u,this.firestore=g,this.loginForm=this.formBuilder.group({email:["",[a.k0.required,a.k0.email]],pass:["",[a.k0.required,a.k0.minLength(6)]]})}ngOnInit(){this.menuController.enable(!1)}login(){var n=this;return(0,P.A)(function*(){if(n.loginForm.invalid)return void _().fire({icon:"warning",title:"Formulario inv\xe1lido",text:"Por favor completa todos los campos correctamente.",confirmButtonText:"OK",heightAuto:!1});const o=yield n.loadingController.create({message:"Cargando...",duration:2e3});yield o.present();try{var i,s;const u=null===(i=n.loginForm.get("email"))||void 0===i?void 0:i.value,g=null===(s=n.loginForm.get("pass"))||void 0===s?void 0:s.value,h=yield n.authService.login(u,g);if(h.user){const T=(0,d.H9)(n.firestore,"usuarios",h.user.uid),v=yield(0,d.x7)(T),c=v.exists()?v.data():null;c&&(localStorage.setItem("usuarioLogin",JSON.stringify(c)),console.log("Usuario logeado:",c)),yield o.dismiss(),"admin"===(null==c?void 0:c.tipo)?n.router.navigate(["/adminhome"]):"dueno"===(null==c?void 0:c.tipo)?n.router.navigate(["/userhome"]):_().fire({icon:"warning",title:"Rol desconocido",text:"Tu rol no tiene acceso definido.",confirmButtonText:"OK",heightAuto:!1})}}catch(u){yield o.dismiss(),console.error(u),_().fire({icon:"error",title:"Error",text:"Hubo un error al iniciar sesi\xf3n.",confirmButtonText:"OK",heightAuto:!1}),n.loginForm.reset()}})()}recovery(){this.router.navigate(["/resetpassword"])}register(){this.router.navigate(["/register"])}}return(r=m).\u0275fac=function(n){return new(n||r)(e.rXU(O.Ix),e.rXU(t.Xi),e.rXU(a.ok),e.rXU(D.u),e.rXU(t._t),e.rXU(d._7))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-login"]],decls:25,vars:7,consts:[[3,"translucent"],[1,"ion-padding"],[1,"banner-container"],["src","../../../../assets/img/logo4.jpg","alt","Banner login",1,"banner-image"],[3,"formGroup"],["formControlName","email","type","email","label","Usuario:","labelPlacement","floating","placeholder","ejemplo@correo.com"],["color","danger",4,"ngIf"],["formControlName","pass","type","password","label","Contrase\xf1a:","labelPlacement","floating","placeholder","m\xednimo 6 caracteres"],["expand","full","color","dark",2,"margin-top","20px",3,"click","disabled"],["expand","full","color","dark","fill","clear",2,"margin-top","10px",3,"click"],["lines","none",2,"margin-top","15px","justify-content","center"],[2,"cursor","pointer","color","var(--ion-color-primary)",3,"click"],["color","danger"]],template:function(n,o){if(1&n&&(e.nrm(0,"ion-header",0),e.j41(1,"ion-content",1)(2,"div",2),e.nrm(3,"img",3),e.k0s(),e.j41(4,"ion-card")(5,"ion-card-header")(6,"ion-card-subtitle"),e.EFF(7,"Ingreso al sistema"),e.k0s()(),e.j41(8,"ion-card-content",4)(9,"ion-item"),e.nrm(10,"ion-input",5),e.k0s(),e.DNE(11,L,2,0,"ion-text",6)(12,C,2,0,"ion-text",6),e.j41(13,"ion-item"),e.nrm(14,"ion-input",7),e.k0s(),e.DNE(15,I,2,0,"ion-text",6)(16,b,2,0,"ion-text",6),e.j41(17,"ion-button",8),e.bIt("click",function(){return o.login()}),e.EFF(18," Ingresar "),e.k0s(),e.j41(19,"ion-button",9),e.bIt("click",function(){return o.register()}),e.EFF(20," Registrarse "),e.k0s(),e.j41(21,"ion-item",10)(22,"ion-label")(23,"a",11),e.bIt("click",function(){return o.recovery()}),e.EFF(24,"\xbfOlvidaste tu contrase\xf1a?"),e.k0s()()()()()()),2&n){let i,s,u,g;e.Y8G("translucent",!0),e.R7$(8),e.Y8G("formGroup",o.loginForm),e.R7$(3),e.Y8G("ngIf",(null==(i=o.loginForm.get("email"))?null:i.hasError("required"))&&(null==(i=o.loginForm.get("email"))?null:i.touched)),e.R7$(),e.Y8G("ngIf",(null==(s=o.loginForm.get("email"))?null:s.hasError("email"))&&(null==(s=o.loginForm.get("email"))?null:s.touched)),e.R7$(3),e.Y8G("ngIf",(null==(u=o.loginForm.get("pass"))?null:u.hasError("required"))&&(null==(u=o.loginForm.get("pass"))?null:u.touched)),e.R7$(),e.Y8G("ngIf",(null==(g=o.loginForm.get("pass"))?null:g.hasError("minlength"))&&(null==(g=o.loginForm.get("pass"))?null:g.touched)),e.R7$(),e.Y8G("disabled",o.loginForm.invalid)}},dependencies:[f.MD,f.bT,t.bv,t.Jm,t.b_,t.I9,t.ME,t.HW,t.W9,t.eU,t.$w,t.uz,t.he,t.IO,t.Gw,a.YN,a.BC,a.cb,a.X1,a.j4,a.JD],styles:[".banner-image[_ngcontent-%COMP%]{width:100%;max-height:180px;object-fit:cover;border-radius:12px}.banner-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-bottom:16px}"]}),m})()}}]);